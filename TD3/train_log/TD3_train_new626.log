nohup: 忽略输入
Env:sumo, Algorithm:TD3, Device:cuda
-----------------------------------------
models/reward_s5e-2(-5, 1)_a4e-2_t(-2_0.1)_safe(4, -0.1).pth
-----------------------------------------
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-14319.888342678652, 速度奖励:-3018.1499999999496, 加速度奖励:-711.2383426792711, 交通灯奖励:-10216.49999999845, 与前车进行交互的惩罚:-374.00000000001654
Episode:1/100, Reward:-14319.888342678652
Episode:1/100, avg speed:14.437917980568516
Episode:1/100, avg halt num:0.3433744722312439
Episode:1/100, avg elec cons:1.762902998089894
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-16813.68323224964, 速度奖励:-3542.549999999914, 加速度奖励:-681.333232250229, 交通灯奖励:-12179.39999999801, 与前车进行交互的惩罚:-410.4000000000248
Episode:2/100, Reward:-16813.68323224964
Episode:2/100, avg speed:14.017458994774065
Episode:2/100, avg halt num:0.4596020761245675
Episode:2/100, avg elec cons:1.8991220424325361
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-13133.909520099494, 速度奖励:-2693.9000000000024, 加速度奖励:-958.0095201002122, 交通灯奖励:-9165.399999998759, 与前车进行交互的惩罚:-316.6000000000035
Episode:3/100, Reward:-13133.909520099494
Episode:3/100, avg speed:15.02067331708596
Episode:3/100, avg halt num:0.2807017543859649
Episode:3/100, avg elec cons:1.93009226334166
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-8969.790277486729, 速度奖励:-3185.0999999999476, 加速度奖励:-782.2902774870473, 交通灯奖励:-4728.600000000115, 与前车进行交互的惩罚:-273.79999999999376
Episode:4/100, Reward:-8969.790277486729
Episode:4/100, avg speed:11.942026020476503
Episode:4/100, avg halt num:0.19138240574506285
Episode:4/100, avg elec cons:1.0069154539023886
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-25052.49682502285, 速度奖励:-8426.549999999985, 加速度奖励:-802.3468250190891, 交通灯奖励:-15124.799999994062, 与前车进行交互的惩罚:-698.8000000000903
Episode:5/100, Reward:-25052.49682502285
Episode:5/100, avg speed:7.235296694957548
Episode:5/100, avg halt num:1.1241496598639455
Episode:5/100, avg elec cons:0.658199747140388
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-13862.422319798252, 速度奖励:-4927.249999999892, 加速度奖励:-830.9723197991742, 交通灯奖励:-7722.099999997651, 与前车进行交互的惩罚:-382.1000000000184
Episode:6/100, Reward:-13862.422319798252
Episode:6/100, avg speed:11.809660221830862
Episode:6/100, avg halt num:0.5096531998569896
Episode:6/100, avg elec cons:1.5771011017363576
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-10317.641928568803, 速度奖励:-3676.5499999999593, 加速度奖励:-787.8919285692352, 交通灯奖励:-5616.099999998505, 与前车进行交互的惩罚:-237.0999999999908
Episode:7/100, Reward:-10317.641928568803
Episode:7/100, avg speed:12.769158498003668
Episode:7/100, avg halt num:0.24890682811974438
Episode:7/100, avg elec cons:1.3847160172465234
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-5723.770600121996, 速度奖励:-2430.800000000002, 加速度奖励:-727.570600122099, 交通灯奖励:-2500.300000000479, 与前车进行交互的惩罚:-65.10000000000058
Episode:8/100, Reward:-5723.770600121996
Episode:8/100, avg speed:14.275685126171227
Episode:8/100, avg halt num:0.07050281074328545
Episode:8/100, avg elec cons:1.6018474112798284
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-6300.36101310938, 速度奖励:-3059.749999999971, 加速度奖励:-695.7110131095434, 交通灯奖励:-2436.1000000004433, 与前车进行交互的惩罚:-108.7999999999981
Episode:9/100, Reward:-6300.36101310938
Episode:9/100, avg speed:12.91606315214671
Episode:9/100, avg halt num:0.07552164434755528
Episode:9/100, avg elec cons:1.1605808925880494
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-15851.556467260667, 速度奖励:-6091.699999999923, 加速度奖励:-1012.3564672619043, 交通灯奖励:-8341.89999999711, 与前车进行交互的惩罚:-405.6000000000237
Episode:10/100, Reward:-15851.556467260667
Episode:10/100, avg speed:8.971011943708515
Episode:10/100, avg halt num:0.4291326684799033
Episode:10/100, avg elec cons:0.4157002558775996
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-17139.634838469578, 速度奖励:-5967.099999999899, 加速度奖励:-1183.934838470169, 交通灯奖励:-9488.89999999574, 与前车进行交互的惩罚:-499.7000000000451
Episode:11/100, Reward:-17139.634838469578
Episode:11/100, avg speed:10.04270192334304
Episode:11/100, avg halt num:0.33824418253248717
Episode:11/100, avg elec cons:0.5093353217096743
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-11240.42686165268, 速度奖励:-4195.099999999904, 加速度奖励:-1229.426861653187, 交通灯奖励:-5432.199999998578, 与前车进行交互的惩罚:-383.70000000001875
Episode:12/100, Reward:-11240.42686165268
Episode:12/100, avg speed:10.831731952504375
Episode:12/100, avg halt num:0.20257208387942333
Episode:12/100, avg elec cons:0.8007950433150907
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-8465.185706141336, 速度奖励:-3757.649999999924, 加速度奖励:-975.5357061415965, 交通灯奖励:-3480.000000000962, 与前车进行交互的惩罚:-251.99999999998997
Episode:13/100, Reward:-8465.185706141336
Episode:13/100, avg speed:12.089043876652681
Episode:13/100, avg halt num:0.20274861025324276
Episode:13/100, avg elec cons:0.8292695600651638
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-5928.689325482267, 速度奖励:-2613.9499999999844, 加速度奖励:-960.6393254823689, 交通灯奖励:-2193.1000000004847, 与前车进行交互的惩罚:-160.99999999999514
Episode:14/100, Reward:-5928.689325482267
Episode:14/100, avg speed:13.357013221330337
Episode:14/100, avg halt num:0.09068627450980392
Episode:14/100, avg elec cons:1.3932250398656354
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-7039.689534677896, 速度奖励:-3349.6999999999475, 加速度奖励:-1034.0895346779823, 交通灯奖励:-2402.2000000007324, 与前车进行交互的惩罚:-253.69999999998987
Episode:15/100, Reward:-7039.689534677896
Episode:15/100, avg speed:12.456190446903252
Episode:15/100, avg halt num:0.08757564969740121
Episode:15/100, avg elec cons:1.1146621314160856
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-7286.9553326611995, 速度奖励:-3400.54999999994, 加速度奖励:-1017.2053326613121, 交通灯奖励:-2595.1000000006147, 与前车进行交互的惩罚:-274.0999999999938
Episode:16/100, Reward:-7286.9553326611995
Episode:16/100, avg speed:11.696200633477062
Episode:16/100, avg halt num:0.0628430296377607
Episode:16/100, avg elec cons:1.0815836844030102
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-7275.315692676126, 速度奖励:-3665.399999999948, 加速度奖励:-1102.0156926761942, 交通灯奖励:-2166.600000000633, 与前车进行交互的惩罚:-341.3000000000091
Episode:17/100, Reward:-7275.315692676126
Episode:17/100, avg speed:11.928242723557307
Episode:17/100, avg halt num:0.09436922060766183
Episode:17/100, avg elec cons:0.8794266886182385
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-14316.4348396289, 速度奖励:-4768.04999999994, 加速度奖励:-1582.6848396297776, 交通灯奖励:-7354.7999999981375, 与前车进行交互的惩罚:-610.9000000000703
Episode:18/100, Reward:-14316.4348396289
Episode:18/100, avg speed:9.391954649082969
Episode:18/100, avg halt num:0.42267441860465116
Episode:18/100, avg elec cons:1.1782643109942745
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-19551.009392854612, 速度奖励:-6845.749999999939, 加速度奖励:-1573.8593928543169, 交通灯奖励:-10375.599999996146, 与前车进行交互的惩罚:-755.8000000001033
Episode:19/100, Reward:-19551.009392854612
Episode:19/100, avg speed:8.414887308527796
Episode:19/100, avg halt num:0.5789559543230016
Episode:19/100, avg elec cons:0.5714709533302387
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-19996.11603231689, 速度奖励:-6476.649999999914, 加速度奖励:-1732.3660323161143, 交通灯奖励:-11155.699999995932, 与前车进行交互的惩罚:-631.400000000075
Episode:20/100, Reward:-19996.11603231689
Episode:20/100, avg speed:8.950732163165888
Episode:20/100, avg halt num:0.42891697877652935
Episode:20/100, avg elec cons:0.5768177388715167
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-17129.472566960998, 速度奖励:-5467.549999999898, 加速度奖励:-1814.4225669613604, 交通灯奖励:-9216.099999996472, 与前车进行交互的惩罚:-631.400000000075
Episode:21/100, Reward:-17129.472566960998
Episode:21/100, avg speed:9.469432199828768
Episode:21/100, avg halt num:0.3082882882882883
Episode:21/100, avg elec cons:0.9160908441385838
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
Traceback (most recent call last):
  File "train_main.py", line 214, in <module>
    rewards, ma_rewards = train()
  File "train_main.py", line 177, in train
    ep_reward_list, avg_speed_list, avg_halt_num_list, avg_elec_cons_list, accel_speed_dict = run_simulation(agent, sumo_cmd, i_ep, cfg)
  File "train_main.py", line 99, in run_simulation
    action_dict = agent.choose_action(current_state_dict)
  File "/home/pc10/sumo_workplace/TD3/agent.py", line 72, in choose_action
    state = torch.FloatTensor(current_state_dict[key]).unsqueeze(0).to(self.device)
RuntimeError: CUDA error: the launch timed out and was terminated
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Error: tcpip::Socket::recvAndCheck @ recv: peer shutdown
Quitting (on error).
