nohup: 忽略输入
Env:sumo, Algorithm:TD3, Device:cuda
-----------------------------------------
models/reward_s9e-3_a4e-2_t(-0.7_0.06)_safe(5, 0.03).pth
-----------------------------------------
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-5133.395834660847, 速度奖励:-930.6574919819515, 加速度奖励:-711.2383426792711, 交通灯奖励:-3370.900000000099, 与前车进行交互的惩罚:-120.6000000000038
Episode:1/100, Reward:-5133.395834660847
Episode:1/100, avg speed:14.437917980568516
Episode:1/100, avg halt num:0.3433744722312439
Episode:1/100, avg elec cons:1.762902998089894
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-6030.976304697676, 速度奖励:-1184.5730724479397, 加速度奖励:-681.333232250229, 交通灯奖励:-4032.1399999999426, 与前车进行交互的惩罚:-132.93000000000427
Episode:2/100, Reward:-6030.976304697676
Episode:2/100, avg speed:14.017458994774065
Episode:2/100, avg halt num:0.4596020761245675
Episode:2/100, avg elec cons:1.8991220424325361
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-4233.921993013172, 速度奖励:-579.0188773619686, 加速度奖励:-829.6231156514349, 交通灯奖励:-2736.3600000001857, 与前车进行交互的惩罚:-88.9200000000026
Episode:3/100, Reward:-4233.921993013172
Episode:3/100, avg speed:15.656170109015065
Episode:3/100, avg halt num:0.2687152664269369
Episode:3/100, avg elec cons:2.040199779447009
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-3743.362177032002, 速度奖励:-500.0709438269734, 加速度奖励:-760.8812332051996, 交通灯奖励:-2402.280000000256, 与前车进行交互的惩罚:-80.13000000000227
Episode:4/100, Reward:-3743.362177032002
Episode:4/100, avg speed:15.079369770135823
Episode:4/100, avg halt num:0.2661600615621393
Episode:4/100, avg elec cons:2.4879664697676924
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-3841.3820423232883, 速度奖励:-534.529447109976, 加速度奖励:-771.4625952134801, 交通灯奖励:-2440.1400000002513, 与前车进行交互的惩罚:-95.25000000000284
Episode:5/100, Reward:-3841.3820423232883
Episode:5/100, avg speed:15.241862289171284
Episode:5/100, avg halt num:0.2714631197097944
Episode:5/100, avg elec cons:2.5268446055329323
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-3863.0243203581144, 速度奖励:-538.8038169659707, 加速度奖励:-769.960503392325, 交通灯奖励:-2469.180000000253, 与前车进行交互的惩罚:-85.08000000000246
Episode:6/100, Reward:-3863.0243203581144
Episode:6/100, avg speed:15.291982854416402
Episode:6/100, avg halt num:0.2696639256346085
Episode:6/100, avg elec cons:2.3003657085194242
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-3983.4809522161386, 速度奖励:-543.4858699379722, 加速度奖励:-788.1150822783442, 交通灯奖励:-2565.6000000002164, 与前车进行交互的惩罚:-86.2800000000025
Episode:7/100, Reward:-3983.4809522161386
Episode:7/100, avg speed:15.558330544453332
Episode:7/100, avg halt num:0.25446581930608037
Episode:7/100, avg elec cons:2.207274125039311
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-15394.61839927843, 速度奖励:-2857.1652094682136, 加速度奖励:-4661.503189809228, 交通灯奖励:-7701.799999995394, 与前车进行交互的惩罚:-174.15000000000583
Episode:8/100, Reward:-15394.61839927843
Episode:8/100, avg speed:10.534164522360435
Episode:8/100, avg halt num:0.33789670192906035
Episode:8/100, avg elec cons:1.353987293020605
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-3230.7977010441696, 速度奖励:-573.2633425769707, 加速度奖励:-833.5643584673159, 交通灯奖励:-1760.5200000004104, 与前车进行交互的惩罚:-63.450000000001644
Episode:9/100, Reward:-3230.7977010441696
Episode:9/100, avg speed:15.01989282236731
Episode:9/100, avg halt num:0.16957017258222076
Episode:9/100, avg elec cons:2.187266835812693
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-2818.553238816661, 速度奖励:-617.8297182569787, 加速度奖励:-702.5635205596984, 交通灯奖励:-1424.060000000397, 与前车进行交互的惩罚:-74.10000000000204
Episode:10/100, Reward:-2818.553238816661
Episode:10/100, avg speed:14.424180227024564
Episode:10/100, avg halt num:0.15270506108202445
Episode:10/100, avg elec cons:2.0872856592893827
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1911.9274782181226, 速度奖励:-638.8690278509888, 加速度奖励:-819.2584503670777, 交通灯奖励:-386.5999999999693, 与前车进行交互的惩罚:-67.20000000000178
Episode:11/100, Reward:-1911.9274782181226
Episode:11/100, avg speed:14.374061284143757
Episode:11/100, avg halt num:0.08319563780568408
Episode:11/100, avg elec cons:2.216664175207564
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-2567.54393251122, 速度奖励:-670.0324854239828, 加速度奖励:-898.3314470872623, 交通灯奖励:-921.7200000002298, 与前车进行交互的惩罚:-77.46000000000217
Episode:12/100, Reward:-2567.54393251122
Episode:12/100, avg speed:14.210126842339369
Episode:12/100, avg halt num:0.12094017094017094
Episode:12/100, avg elec cons:2.4121124035809727
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1991.077285456461, 速度奖励:-578.3091184079849, 加速度奖励:-747.1381670483896, 交通灯奖励:-610.2800000000677, 与前车进行交互的惩罚:-55.35000000000134
Episode:13/100, Reward:-1991.077285456461
Episode:13/100, avg speed:14.691894140575892
Episode:13/100, avg halt num:0.10210824417872875
Episode:13/100, avg elec cons:2.3615770575481934
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1951.6111217692787, 速度奖励:-608.333729417985, 加速度奖励:-765.817392351206, 交通灯奖励:-511.51999999997196, 与前车进行交互的惩罚:-65.94000000000173
Episode:14/100, Reward:-1951.6111217692787
Episode:14/100, avg speed:14.268265271938564
Episode:14/100, avg halt num:0.114950634696756
Episode:14/100, avg elec cons:2.538738087308992
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-3106.656060902467, 速度奖励:-807.3929553389896, 加速度奖励:-979.8931055635052, 交通灯奖励:-1220.4000000005067, 与前车进行交互的惩罚:-98.97000000000298
Episode:15/100, Reward:-3106.656060902467
Episode:15/100, avg speed:13.557988398788721
Episode:15/100, avg halt num:0.1201536210680322
Episode:15/100, avg elec cons:2.324353237056594
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-2258.260906109299, 速度奖励:-673.6387088789884, 加速度奖励:-810.2321972302869, 交通灯奖励:-700.7400000001452, 与前车进行交互的惩罚:-73.65000000000202
Episode:16/100, Reward:-2258.260906109299
Episode:16/100, avg speed:13.727843541308028
Episode:16/100, avg halt num:0.09074632491519036
Episode:16/100, avg elec cons:2.5883998401250397
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1997.090881803563, 速度奖励:-685.5621272099985, 加速度奖励:-850.6487545935089, 交通灯奖励:-378.7999999999691, 与前车进行交互的惩罚:-82.08000000000234
Episode:17/100, Reward:-1997.090881803563
Episode:17/100, avg speed:13.86951268961972
Episode:17/100, avg halt num:0.06487829962290025
Episode:17/100, avg elec cons:2.469012038260545
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1906.4923686318564, 速度奖励:-606.0156436259921, 加速度奖励:-781.2667250058075, 交通灯奖励:-446.7599999999656, 与前车进行交互的惩罚:-72.45000000000198
Episode:18/100, Reward:-1906.4923686318564
Episode:18/100, avg speed:13.093486801508588
Episode:18/100, avg halt num:0.07659660468876314
Episode:18/100, avg elec cons:2.785634145486805
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1692.836922748879, 速度奖励:-608.1148000529939, 加速度奖励:-669.0421226958332, 交通灯奖励:-351.5399999999688, 与前车进行交互的惩罚:-64.14000000000166
Episode:19/100, Reward:-1692.836922748879
Episode:19/100, avg speed:14.21225883365845
Episode:19/100, avg halt num:0.0826750448833034
Episode:19/100, avg elec cons:2.3567825514804577
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1371.221424906548, 速度奖励:-567.4823043659991, 加速度奖励:-646.1991205405064, 交通灯奖励:-98.49999999998417, 与前车进行交互的惩罚:-59.04000000000148
Episode:20/100, Reward:-1371.221424906548
Episode:20/100, avg speed:14.444054941214548
Episode:20/100, avg halt num:0.03943377148634985
Episode:20/100, avg elec cons:2.255676354312123
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1523.5509322968871, 速度奖励:-628.8311475269987, 加速度奖励:-682.3497847698518, 交通灯奖励:-150.5399999999761, 与前车进行交互的惩罚:-61.83000000000158
Episode:21/100, Reward:-1523.5509322968871
Episode:21/100, avg speed:13.7662858005595
Episode:21/100, avg halt num:0.037065637065637064
Episode:21/100, avg elec cons:2.5047863438734526
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1398.4879091461894, 速度奖励:-597.4019707590005, 加速度奖励:-693.9359383871655, 交通灯奖励:-66.43999999999394, 与前车进行交互的惩罚:-40.71000000000078
Episode:22/100, Reward:-1398.4879091461894
Episode:22/100, avg speed:13.744186315040682
Episode:22/100, avg halt num:0.016382821177341727
Episode:22/100, avg elec cons:2.472773390194225
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1145.5497308388042, 速度奖励:-586.031619150002, 加速度奖励:-575.2881116887842, 交通灯奖励:61.2200000000138, 与前车进行交互的惩罚:-45.45000000000096
Episode:23/100, Reward:-1145.5497308388042
Episode:23/100, avg speed:14.280117143924365
Episode:23/100, avg halt num:0.008629356568364612
Episode:23/100, avg elec cons:2.051016650895193
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1337.7562348983674, 速度奖励:-615.6377858250033, 加速度奖励:-664.428449073343, 交通灯奖励:-7.499999999996549, 与前车进行交互的惩罚:-50.19000000000114
Episode:24/100, Reward:-1337.7562348983674
Episode:24/100, avg speed:14.063377653268596
Episode:24/100, avg halt num:0.009795851168916694
Episode:24/100, avg elec cons:2.0363211525028166
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1420.0564387503712, 速度奖励:-602.7340105259992, 加速度奖励:-735.9524282243457, 交通灯奖励:-34.119999999989666, 与前车进行交互的惩罚:-47.25000000000103
Episode:25/100, Reward:-1420.0564387503712
Episode:25/100, avg speed:14.019129869567696
Episode:25/100, avg halt num:0.018474974806852538
Episode:25/100, avg elec cons:2.035572487504846
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1758.6357062568236, 速度奖励:-696.013208811003, 加速度奖励:-857.232497445785, 交通灯奖励:-141.63999999997986, 与前车进行交互的惩罚:-63.750000000001656
Episode:26/100, Reward:-1758.6357062568236
Episode:26/100, avg speed:13.290312747123913
Episode:26/100, avg halt num:0.05068991950939057
Episode:26/100, avg elec cons:2.3872802927198515
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1645.8067358270307, 速度奖励:-667.6218672479957, 加速度奖励:-868.1548685789966, 交通灯奖励:-45.499999999998494, 与前车进行交互的惩罚:-64.53000000000168
Episode:27/100, Reward:-1645.8067358270307
Episode:27/100, avg speed:13.598302708362397
Episode:27/100, avg halt num:0.045661301609517146
Episode:27/100, avg elec cons:2.2818785686607015
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1600.5731918295671, 速度奖励:-618.3915306750008, 加速度奖励:-851.4516611545379, 交通灯奖励:-62.659999999994476, 与前车进行交互的惩罚:-68.07000000000181
Episode:28/100, Reward:-1600.5731918295671
Episode:28/100, avg speed:12.979318849012754
Episode:28/100, avg halt num:0.03280032800328003
Episode:28/100, avg elec cons:2.8108507440892834
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1427.339857076713, 速度奖励:-631.8925633619994, 加速度奖励:-829.9272937146761, 交通灯奖励:103.78000000000898, 与前车进行交互的惩罚:-69.30000000000186
Episode:29/100, Reward:-1427.339857076713
Episode:29/100, avg speed:13.390186183429643
Episode:29/100, avg halt num:0.0212
Episode:29/100, avg elec cons:2.7364494923256424
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-1638.949637532699, 速度奖励:-619.6543084260052, 加速度奖励:-861.6253291066548, 交通灯奖励:-86.35999999998378, 与前车进行交互的惩罚:-71.31000000000193
Episode:30/100, Reward:-1638.949637532699
Episode:30/100, avg speed:14.046189072471828
Episode:30/100, avg halt num:0.01928422515635858
Episode:30/100, avg elec cons:2.50137992838363
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-2492.08075584499, 速度奖励:-708.8962979790073, 加速度奖励:-1254.6344578659794, 交通灯奖励:-445.59999999996853, 与前车进行交互的惩罚:-82.95000000000238
Episode:31/100, Reward:-2492.08075584499
Episode:31/100, avg speed:13.300552346567137
Episode:31/100, avg halt num:0.011372041420118344
Episode:31/100, avg elec cons:2.774796014118021
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-2293.5231992634003, 速度奖励:-758.9920709790055, 加速度奖励:-1042.7811282843727, 交通灯奖励:-423.3799999999627, 与前车进行交互的惩罚:-68.37000000000182
Episode:32/100, Reward:-2293.5231992634003
Episode:32/100, avg speed:12.935073153852972
Episode:32/100, avg halt num:0.04066320859577621
Episode:32/100, avg elec cons:2.3698910987351858
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
总奖励:-2667.0199669807357, 速度奖励:-858.512454876009, 加速度奖励:-1382.3875121047329, 交通灯奖励:-368.7599999999682, 与前车进行交互的惩罚:-57.36000000000141
Episode:33/100, Reward:-2667.0199669807357
Episode:33/100, avg speed:12.186722911368232
Episode:33/100, avg halt num:0.005457380457380458
Episode:33/100, avg elec cons:2.386312621035439
 Retrying in 1 seconds
Warning: Unused states in tlLogic 'J10', program '0' in phase 0 after tl-index 10
Simulation......
Traceback (most recent call last):
  File "train_main.py", line 215, in <module>
    rewards, ma_rewards = train()
  File "train_main.py", line 176, in train
    ep_reward_list, avg_speed_list, avg_halt_num_list, avg_elec_cons_list, accel_speed_dict = run_simulation(agent, sumo_cmd, i_ep, cfg)
  File "train_main.py", line 99, in run_simulation
    action_dict = agent.choose_action(current_state_dict)
  File "/home/pc10/sumo_workplace/TD3/agent.py", line 73, in choose_action
    state = torch.FloatTensor(current_state_dict[key]).unsqueeze(0).to(self.device)
RuntimeError: CUDA error: the launch timed out and was terminated
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Error: tcpip::Socket::recvAndCheck @ recv: peer shutdown
Quitting (on error).
